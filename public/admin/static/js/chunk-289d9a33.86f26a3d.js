(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-289d9a33"],{"008a":function(t,e,a){"use strict";a("b5b7")},"0c21":function(t,e,a){"use strict";a("ed69")},8593:function(t,e,a){"use strict";a.d(e,"h",(function(){return o})),a.d(e,"g",(function(){return r})),a.d(e,"f",(function(){return c})),a.d(e,"n",(function(){return s})),a.d(e,"r",(function(){return l})),a.d(e,"b",(function(){return d})),a.d(e,"j",(function(){return u})),a.d(e,"i",(function(){return m})),a.d(e,"q",(function(){return f})),a.d(e,"m",(function(){return p})),a.d(e,"a",(function(){return h})),a.d(e,"l",(function(){return b})),a.d(e,"d",(function(){return v})),a.d(e,"e",(function(){return _})),a.d(e,"p",(function(){return y})),a.d(e,"t",(function(){return g})),a.d(e,"k",(function(){return C})),a.d(e,"o",(function(){return V})),a.d(e,"s",(function(){return E})),a.d(e,"c",(function(){return x}));a("99af");var n=a("b775"),i="/system";function o(){return Object(n["a"])({url:"".concat(i,"/menus"),method:"get"})}function r(t){return Object(n["a"])({url:"".concat(i,"/menus/").concat(t),method:"get"})}function c(){return Object(n["a"])({url:"".concat(i,"/menus/create"),method:"get"})}function s(t){return Object(n["a"])({url:"".concat(i,"/menus"),method:"post",data:t})}function l(t){return Object(n["a"])({url:"".concat(i,"/menus/").concat(t.id),method:"put",data:t})}function d(t){return Object(n["a"])({url:"".concat(i,"/menus/").concat(t),method:"delete"})}function u(){return Object(n["a"])({url:"".concat(i,"/routeCate"),method:"get"})}function m(t){return Object(n["a"])({url:"".concat(i,"/routeList/").concat(t),method:"get"})}function f(t){return Object(n["a"])({url:"".concat(i,"/saveSelectRouteRule"),method:"post",data:{menus:t}})}function p(){return Object(n["a"])({url:"".concat(i,"/uniqueMenus"),method:"get"})}function h(t){return Object(n["a"])({url:"".concat(i,"/changeShowMenus/").concat(t.id),method:"put",data:t})}function b(t){return Object(n["a"])({url:"".concat(i,"/route/tree/").concat(t),method:"get"})}function v(t,e){return Object(n["a"])({url:"".concat(i,"/routeCate/delete/").concat(t,"/").concat(e),method:"delete"})}function _(t,e){return Object(n["a"])({url:"".concat(i,"/route/deleteAllApi/").concat(t,"/").concat(e),method:"delete"})}function y(t){return Object(n["a"])({url:"".concat(i,"/routeCate"),method:"post",data:t})}function g(t){return Object(n["a"])({url:"".concat(i,"/routeCate/").concat(t.id),method:"put",data:t})}function C(t){return Object(n["a"])({url:"".concat(i,"/routeApi/").concat(t),method:"get"})}function V(t){return Object(n["a"])({url:"".concat(i,"/routeApi"),method:"post",data:t})}function E(t){return Object(n["a"])({url:"".concat(i,"/routeApi/").concat(t.id),method:"put",data:t})}function x(t){return Object(n["a"])({url:"".concat(i,"/routeApi/").concat(t),method:"delete"})}},b5b7:function(t,e,a){},ed69:function(t,e,a){},fde9:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"box-card"},[a("el-tabs",{model:{value:t.apiType,callback:function(e){t.apiType=e},expression:"apiType"}},[a("el-tab-pane",{attrs:{label:"管理端接口",name:"adminapi"}}),a("el-tab-pane",{attrs:{label:"用户端接口",name:"api"}})],1),a("div",{staticClass:"d-flex"},[a("div",{staticClass:"d-mr-20"},[a("el-button",{staticClass:"d-w-100 d-mb-10",attrs:{type:"primary"},on:{click:t.addTopCate}},[t._v("新增分类")]),a("el-tree",{ref:"el_tree",staticClass:"el-tree",attrs:{data:t.treeData,"node-key":"id",props:{children:"children",label:"name"},"default-expanded-keys":t.expandKey},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(e){e.node;var n=e.data;return a("span",{staticClass:"d-flex-1"},[[a("div",{staticClass:"d-flex d-justify-between"},[a("div",{staticClass:"d-overflow-hidden d-text-wrap"},["DELETE"!==n.method?a("span",{style:{color:t.methodsColor(n.method)}},[t._v(t._s(n.method)+" ")]):a("span",{style:{color:t.methodsColor(n.method)}},[t._v("DEL ")]),a("span",[t._v(t._s(n.name))])]),a("el-dropdown",{on:{command:function(e){return t.handleDropdown(e,n)}}},[a("i",{staticClass:"el-icon-more-outline"}),a("el-dropdown-menu",[0!==n.pid||n.method?t._e():a("el-dropdown-item",{attrs:{command:"0",icon:"el-icon-plus"}},[t._v("新增分类")]),n.method?t._e():a("el-dropdown-item",{attrs:{command:"1",icon:"el-icon-circle-plus"}},[t._v("新增API接口")]),n.method?t._e():a("el-dropdown-item",{attrs:{command:"2",icon:"el-icon-edit"}},[t._v("修改分类名称")]),n.method?t._e():a("el-dropdown-item",{attrs:{command:"3",icon:"el-icon-delete"}},[t._v("删除分类")]),n.method?a("el-dropdown-item",{attrs:{command:"4",icon:"el-icon-delete"}},[t._v("删除接口")]):t._e(),!n.method&&n.children.length&&n.children[0].cate_id?a("el-dropdown-item",{staticStyle:{color:"red"},attrs:{icon:"el-icon-delete",command:"5"}},[t._v("删除全部接口")]):t._e()],1)],1)],1)]],2)}}])})],1),a("route-form",{ref:"routeForm",staticClass:"d-w-100",attrs:{"methods-color":t.methodsColor},on:{changeExpandKey:t.changeExpandKey,initData:t.initData}})],1)],1),a("el-dialog",{attrs:{title:"添加分类",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{model:t.form,"label-width":"80px",size:"mini"}},[t.form.pid&&t.form.parentName?[a("el-form-item",{attrs:{label:"父类名称"}},[a("el-input",{attrs:{value:t.form.parentName,"auto-complete":"off",disabled:""}})],1)]:t._e(),a("el-form-item",{attrs:{label:"分类名称"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入分类名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.save}},[t._v("保 存")])],1)],1)],1)},i=[],o=(a("b0c0"),a("d3b7"),a("8593")),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-px-20 d-border-left d-border-gray"},[a("div",{staticClass:"d-mt-10 d-flex d-justify-between d-align-center"},[a("span",{staticClass:"d-font-22"},[t._v(t._s(t.formValidate.name))]),a("div",[t.isEdit?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.handleSave}},[t._v("保存")]):a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.isEdit=!0}}},[t._v("编辑")]),t.isEdit&&!t.isCreate?a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.isEdit=!1}}},[t._v("取消")]):t._e()],1)]),a("el-form",{ref:"formValidate",staticClass:"d-mt-20 d-w-70",attrs:{model:t.formValidate,"label-width":"130px",size:"mini"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("div",{staticClass:"d-mb-20"},[t._v("接口信息")]),a("el-form-item",{attrs:{label:"接口名称：",prop:"name"}},[t.isEdit?a("el-input",{attrs:{type:"text",placeholder:"请输入"},model:{value:t.formValidate.name,callback:function(e){t.$set(t.formValidate,"name","string"===typeof e?e.trim():e)},expression:"formValidate.name"}}):a("span",[t._v(t._s(t.formValidate.name||""))])],1),t.isEdit&&t.isCreate?a("el-form-item",{attrs:{label:"是否为资源路由：",prop:"name"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.is_resource,callback:function(e){t.is_resource=e},expression:"is_resource"}})],1):t._e(),t.is_resource?t._e():a("el-form-item",{attrs:{label:"请求类型：",prop:"name"}},[t.isEdit?a("el-select",{staticStyle:{width:"120px"},model:{value:t.formValidate.method,callback:function(e){t.$set(t.formValidate,"method",e)},expression:"formValidate.method"}},t._l(t.requestTypeList,(function(t,e){return a("el-option",{key:e,attrs:{value:t.value,label:t.label}})})),1):a("span",{staticClass:"d-p-5 d-border-radius",staticStyle:{color:"white"},style:{backgroundColor:t.methodsColor(t.formValidate.method)}},[t._v(" "+t._s(t.formValidate.method||"")+" ")])],1),a("el-form-item",{attrs:{label:"功能描述：",prop:"name"}},[t.isEdit?a("el-input",{attrs:{type:"textarea",placeholder:"请输入"},model:{value:t.formValidate.describe,callback:function(e){t.$set(t.formValidate,"describe","string"===typeof e?e.trim():e)},expression:"formValidate.describe"}}):a("span",{staticClass:"text-area"},[t._v(t._s(t.formValidate.describe||"--"))])],1),t.isEdit?a("el-form-item",{attrs:{label:"所属分类：",prop:"name"}},[a("el-cascader",{key:t.resetCascader,attrs:{size:"small",options:t.formValidate.route_tree,props:{checkStrictly:!0,multiple:!1,emitPath:!1,value:"id",label:"name"},clearable:""},model:{value:t.formValidate.cate_id,callback:function(e){t.$set(t.formValidate,"cate_id",e)},expression:"formValidate.cate_id"}})],1):t._e(),a("el-form-item",{attrs:{label:"路由地址：",prop:"path"}},[t.isEdit?a("el-input",{attrs:{type:"text",placeholder:"请输入"},model:{value:t.formValidate.path,callback:function(e){t.$set(t.formValidate,"path","string"===typeof e?e.trim():e)},expression:"formValidate.path"}}):a("span",[t._v(t._s(t.formValidate.path||""))])],1)],1)],1)},c=[],s={props:{methodsColor:{type:Function,default:null},parentInitData:{type:Function,default:null}},data:function(){return{isEdit:!1,isCreate:!1,is_resource:!1,formValidate:{name:"",method:"",describe:"",cate_id:"",path:"",action:""},requestTypeList:[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"PUT",value:"PUT"},{label:"DELETE",value:"DELETE"}],resetCascader:0}},methods:{initData:function(t){this.getRouteDetail(t)},getRouteDetail:function(t){var e=this;Object(o["k"])(t).then((function(t){e.resetCascader++,e.isEdit&&(e.isEdit=!1),e.isCreate&&(e.isCreate=!1),e.formValidate=t.data})).catch((function(){}))},handleSave:function(){var t=this;this.formValidate.is_resource=this.is_resource;var e=this.formValidate.id?o["s"]:o["o"];e(this.formValidate).then((function(e){t.$message.success(e.msg);var a=Array.isArray(e.data)?e.data[0].id:e.data.id;t.$emit("changeExpandKey",t.formValidate.id?t.formValidate.id:a)})).catch((function(){}))},resetForm:function(){this.is_resource=!1,this.$refs.formValidate.resetFields()}}},l=s,d=(a("008a"),a("2877")),u=Object(d["a"])(l,r,c,!1,null,"37124c66",null),m=u.exports,f={components:{routeForm:m},data:function(){return{apiType:"adminapi",treeData:[],expandKey:[],dialogFormVisible:!1,form:{pid:0,parentName:"",name:"",app_name:"adminapi"}}},watch:{apiType:function(t){this.form.app_name=t,this.initData()}},mounted:function(){this.initData()},methods:{initData:function(){var t=this;this.getData(this.apiType).then((function(){t.getFirstCateId(t.treeData),t.$refs.routeForm.getRouteDetail(t.expandKey)}))},changeExpandKey:function(t){var e=this;this.expandKey=[t],this.getData(this.apiType).then((function(){e.$refs.routeForm.getRouteDetail(e.expandKey)}))},getData:function(t){var e=this;return new Promise((function(a){Object(o["l"])(t).then((function(t){e.treeData=t.data,a()})).catch((function(){}))}))},handleNodeClick:function(t){t.cate_id&&(this.$refs.routeForm.getRouteDetail(t.id),this.$refs.routeForm.isEdit=!1,this.$refs.routeForm.isCreate=!1,this.$refs.routeForm.is_resource=!1)},getFirstCateId:function(t){for(var e=0;e<t.length;e++){if(t[e].children&&t[e].children.length){var a=this.getFirstCateId(t[e].children);if(a)return a}if(t[e].cate_id)return this.expandKey=[t[e].id],t[e].id}return null},handleDropdown:function(t,e){var a=this,n=this.$refs.routeForm;switch(t){case"0":this.form.pid=e.id,this.form.parentName=e.name,this.dialogFormVisible=!0;break;case"1":n.isEdit=!0,n.isCreate=!0,n.formValidate.id="",n.formValidate.cate_id=e.id,n.resetForm();break;case"2":this.form.id=e.id,this.form.name=e.name,this.dialogFormVisible=!0;break;case"3":this.$confirm('确定要删除此分类吗？<br/><span style="color: red;font-size: 12px">注：会删除此分类下的所有子分类</span>',"提示",{type:"warning",dangerouslyUseHTMLString:!0}).then((function(){a.deleteCate(e)})).catch((function(){}));break;case"4":this.$confirm("确定要删除此接口吗？","提示",{type:"warning"}).then((function(){a.deleteApi(e)})).catch((function(){}));break;case"5":this.$confirm('确定要删除此分类下的所有接口吗？<br/><span style="color: red;font-size: 12px">注：会删除此分类下的所有接口，请谨慎操作!</span>',"提示",{type:"warning",dangerouslyUseHTMLString:!0}).then((function(){a.deleteAllApi(e)})).catch((function(){}));break}},addTopCate:function(){this.resetData(),this.dialogFormVisible=!0},save:function(){var t=this;if(!this.form.name)return this.$message.error("名称不能为空");var e=this.form.id?o["t"]:o["p"];e(this.form).then((function(e){t.$message.success(e.msg),t.getData(t.apiType),t.dialogFormVisible=!1,t.resetData()})).catch((function(){}))},deleteCate:function(t){var e=this;Object(o["d"])(t.id,this.apiType).then((function(t){e.$message.success(t.msg),e.getData(e.apiType)})).catch((function(){}))},deleteApi:function(t){var e=this;Object(o["c"])(t.id).then((function(t){e.$message.success(t.msg),e.initData()})).catch((function(){}))},deleteAllApi:function(t){var e=this;Object(o["e"])(t.id,this.apiType).then((function(t){e.$message.success(t.msg),e.initData()})).catch((function(){}))},methodsColor:function(t){if(!t)return!1;var e=t.toUpperCase();return"GET"===e?"#61affe":"POST"===e?"#49cc90":"PUT"===e?"#fca130":"DEL"===e||"DELETE"===e?"#f93e3e":void 0},resetData:function(){this.form={pid:0,parentName:"",name:"",app_name:this.apiType}}}},p=f,h=(a("0c21"),Object(d["a"])(p,n,i,!1,null,"1a5efbd7",null));e["default"]=h.exports}}]);