(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1bb8cce7"],{"18e4":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"box-card"},[a("el-button",{staticClass:"d-mb-10",attrs:{type:"primary",size:"mini"},on:{click:t.add}},[t._v("添加角色")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading__,expression:"loading__"}],attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"id",label:"id"}}),a("el-table-column",{attrs:{prop:"role_name",label:"角色名称"}}),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-switch",{attrs:{"active-value":1},on:{change:function(e){return t.changeSwitch(n)}},model:{value:n.status,callback:function(e){t.$set(n,"status",e)},expression:"row.status"}})]}}])}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.edit(n.id)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.deleteRole(n.id)}}},[t._v("删除")])]}}])})],1),a("pagination",{attrs:{total:t.total__,page:t.currentPage__,limit:t.limit__},on:{"update:page":function(e){t.currentPage__=e},"update:limit":function(e){t.limit__=e},pagination:t.initData}})],1),a("role-form",{ref:"roleForm",attrs:{title:t.title},on:{initData:t.initData}})],1)},i=[],o=a("90e7"),c=a("a682"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,width:"50%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"form",attrs:{model:t.formData,"label-width":"80px",size:"mini"}},[a("el-form-item",{attrs:{label:"角色名称"}},[a("el-input",{attrs:{placeholder:"填写角色名称"},model:{value:t.formData.role_name,callback:function(e){t.$set(t.formData,"role_name",e)},expression:"formData.role_name"}})],1),a("el-form-item",{attrs:{label:"角色状态"}},[a("el-radio-group",{model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}},[a("el-radio",{attrs:{label:1}},[t._v("开启")]),a("el-radio",{attrs:{label:0}},[t._v("关闭")])],1)],1),a("el-form-item",{attrs:{label:"角色权限"}},[a("div",{staticClass:"trees-coadd"},[a("div",{staticClass:"scollhide"},[a("el-tree",{ref:"tree",attrs:{data:t.routeList,props:{children:"children",label:"label"},"show-checkbox":"","node-key":"value","default-expanded-keys":t.expandedKeys},on:{check:t.handleCheckChange}})],1)])])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:t.handleClose}},[t._v("取 消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.save}},[t._v("保 存")])],1)],1)],1)},l=[],u=(a("d81d"),a("d3b7"),a("159b"),{props:{title:{type:String,default:"提示"}},data:function(){return{dialogVisible:!1,routeList:[],formData:{role_name:"",status:1},checkRuleBox:[],expandedKeys:[]}},methods:{initData:function(){var t=this;Object(o["f"])().then((function(e){t.routeList=e.data}))},getDetail:function(t){var e=this;Object(o["g"])(t).then((function(t){e.formData=t.data,e.$nextTick((function(a){setTimeout((function(){t.data.rules.forEach((function(a){var n=e.$refs.tree.getNode(a);e.$refs.tree.setChecked(n,!0),e.expandedKeys=t.data.rules}))}),300)}))})).catch((function(){}))},save:function(){var t=this;if(!this.formData.role_name)return this.$message.error("请填写角色名称");this.formData.rules=this.checkRuleBox.length?this.checkRuleBox:this.expandedKeys;var e=this.formData.id?o["m"]:o["j"];e(this.formData).then((function(e){t.$message.success(e.msg),t.handleClose(),t.$emit("initData")})).catch((function(){}))},handleCheckChange:function(){var t=this.$refs.tree.getCheckedNodes(!1,!0);this.checkRuleBox=t.map((function(t){return t.value}))},handleClose:function(t){Object.assign(this.$data,this.$options.data()),"function"===typeof t?t():this.dialogVisible=!1}}}),s=u,d=(a("7a8a"),a("2877")),f=Object(d["a"])(s,r,l,!1,null,"17fb9dda",null),m=f.exports,h={components:{roleForm:m},mixins:[c["a"]],data:function(){return{tableData:[],title:""}},mounted:function(){this.initData()},methods:{initData:function(){var t=this;this.loading__=!0;var e={page:this.currentPage__,limit:this.limit__};Object(o["h"])(e).then((function(e){var a=e.data;t.tableData=a.list,t.total__=a.count,t.loading__=!1})).catch((function(){}))},add:function(){this.openDialog("添加角色")},edit:function(t){this.openDialog("编辑角色"),this.$refs.roleForm.getDetail(t)},deleteRole:function(t){var e=this;this.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["b"])(t).then((function(t){e.$message.success("删除成功"),e.initData()})).catch((function(){}))})).catch((function(){}))},changeSwitch:function(t){var e=this,a=t.id,n=t.status,i={id:a,status:n};Object(o["n"])(i).then((function(t){e.$message.success("修改成功"),e.initData()})).catch((function(){}))},openDialog:function(t){this.title=t;var e=this.$refs.roleForm;e.dialogVisible=!0,e.initData()}}},b=h,p=Object(d["a"])(b,n,i,!1,null,"7ca03e37",null);e["default"]=p.exports},"7a8a":function(t,e,a){"use strict";a("a9a6")},"90e7":function(t,e,a){"use strict";a.d(e,"h",(function(){return o})),a.d(e,"f",(function(){return c})),a.d(e,"j",(function(){return r})),a.d(e,"g",(function(){return l})),a.d(e,"m",(function(){return u})),a.d(e,"n",(function(){return s})),a.d(e,"b",(function(){return d})),a.d(e,"e",(function(){return f})),a.d(e,"i",(function(){return m})),a.d(e,"k",(function(){return h})),a.d(e,"a",(function(){return b})),a.d(e,"c",(function(){return p})),a.d(e,"d",(function(){return g})),a.d(e,"l",(function(){return _}));a("99af");var n=a("b775"),i="setting";function o(t){return Object(n["a"])({url:"".concat(i,"/role?page=").concat(t.page,"&limit=").concat(t.limit),method:"get"})}function c(){return Object(n["a"])({url:"".concat(i,"/role/create"),method:"get"})}function r(t){return Object(n["a"])({url:"".concat(i,"/role"),method:"post",data:t})}function l(t){return Object(n["a"])({url:"".concat(i,"/role/").concat(t),method:"get"})}function u(t){return Object(n["a"])({url:"".concat(i,"/role/").concat(t.id),method:"put",data:t})}function s(t){return Object(n["a"])({url:"".concat(i,"/updateStatus/").concat(t.id),method:"put",data:t})}function d(t){return Object(n["a"])({url:"".concat(i,"/role/").concat(t),method:"delete"})}function f(t){return Object(n["a"])({url:"".concat(i,"/admin?page=").concat(t.page,"&limit=").concat(t.limit),method:"get"})}function m(t){return Object(n["a"])({url:"".concat(i,"/admin"),method:"post",data:t})}function h(t){return Object(n["a"])({url:"".concat(i,"/admin/").concat(t.id),method:"put",data:t})}function b(t){return Object(n["a"])({url:"".concat(i,"/admin/").concat(t),method:"delete"})}function p(){return Object(n["a"])({url:"".concat(i,"/admin/create"),method:"get"})}function g(t){return Object(n["a"])({url:"".concat(i,"/admin/").concat(t),method:"get"})}function _(t){return Object(n["a"])({url:"".concat(i,"/updateAdminStatus/").concat(t.id),method:"put",data:t})}},a682:function(t,e,a){"use strict";e["a"]={data:function(){return{loading__:!0,currentPage__:1,limit__:20,total__:0}}}},a9a6:function(t,e,a){}}]);