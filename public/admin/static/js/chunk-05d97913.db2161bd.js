(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05d97913"],{"0aa4":function(e,t,a){"use strict";a("6453")},"318c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.isShowForm?a("code-generation-form",{on:{back:e.back}}):a("el-card",[a("el-button",{staticClass:"d-mb-10",attrs:{type:"primary",size:"mini"},on:{click:e.add}},[e._v("添加功能")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading__,expression:"loading__"}],attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"id",label:"id"}}),a("el-table-column",{attrs:{prop:"name",label:"菜单名"}}),a("el-table-column",{attrs:{prop:"table_name",label:"表名"}}),a("el-table-column",{attrs:{prop:"model_name",label:"模型名"}}),a("el-table-column",{attrs:{prop:"table_comment",label:"备注"}}),a("el-table-column",{attrs:{prop:"update_time",label:"修改时间"}}),a("el-table-column",{attrs:{prop:"add_time",label:"添加时间"}}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.edit(r.id)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.del(r.id)}}},[e._v("删除")])]}}],null,!1,1868075095)})],1)],1)],1)},l=[],i=(a("99af"),a("b775")),n="/system";function o(e){return Object(i["a"])({url:"".concat(n,"/codeGeneration?page=").concat(e.page,"&limit=").concat(e.limit),method:"get"})}function s(){return Object(i["a"])({url:"".concat(n,"/codeGeneration/create"),method:"get"})}function c(e){return Object(i["a"])({url:"".concat(n,"/getTableName/").concat(e),method:"get"})}function u(e){return Object(i["a"])({url:"".concat(n,"/codeGeneration"),method:"post",data:e})}function m(e){return Object(i["a"])({url:"".concat(n,"/codeGeneration/").concat(e),method:"delete"})}var d=a("a682"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"d-mb-10"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.back}},[e._v("返回")])],1),a("el-card",[a("el-steps",{staticClass:"d-m-auto d-w-80 d-mb-20",attrs:{active:e.active,"align-center":"","finish-status":"finish"}},[a("el-step",{attrs:{title:"基础信息"}}),a("el-step",{attrs:{title:"字段配置"}})],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],ref:"form",attrs:{rules:e.rules,size:"mini",model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"父级菜单"}},[a("el-cascader",{staticClass:"d-w-40",attrs:{options:e.menuList,props:{checkStrictly:!0},clearable:""},model:{value:e.form.menu_path,callback:function(t){e.$set(e.form,"menu_path",t)},expression:"form.menu_path"}})],1),a("el-form-item",{attrs:{label:"表名",prop:"table_name"}},[a("el-input",{staticClass:"d-w-40",attrs:{placeholder:"填写表名,下面表单会自动生成"},on:{blur:e.table_name_blur},model:{value:e.form.table_name,callback:function(t){e.$set(e.form,"table_name",t)},expression:"form.table_name"}})],1),a("el-form-item",{attrs:{label:"菜单名",prop:"menu_name"}},[a("el-input",{staticClass:"d-w-40",attrs:{placeholder:"填写菜单名"},model:{value:e.form.menu_name,callback:function(t){e.$set(e.form,"menu_name",t)},expression:"form.menu_name"}})],1),a("el-form-item",{attrs:{label:"模块名",prop:"model_name"}},[a("el-input",{staticClass:"d-w-40",attrs:{placeholder:"填写模块名"},model:{value:e.form.model_name,callback:function(t){e.$set(e.form,"model_name",t)},expression:"form.model_name"}})],1),a("el-form-item",{attrs:{label:"控制器",prop:"make_path.controller"}},[a("el-input",{model:{value:e.form.make_path.controller,callback:function(t){e.$set(e.form.make_path,"controller",t)},expression:"form.make_path.controller"}})],1),a("el-form-item",{attrs:{label:"模型",prop:"make_path.model"}},[a("el-input",{model:{value:e.form.make_path.model,callback:function(t){e.$set(e.form.make_path,"model",t)},expression:"form.make_path.model"}})],1),a("el-form-item",{attrs:{label:"dao层",prop:"make_path.dao"}},[a("el-input",{model:{value:e.form.make_path.dao,callback:function(t){e.$set(e.form.make_path,"dao",t)},expression:"form.make_path.dao"}})],1),a("el-form-item",{attrs:{label:"service层",prop:"make_path.service"}},[a("el-input",{model:{value:e.form.make_path.service,callback:function(t){e.$set(e.form.make_path,"service",t)},expression:"form.make_path.service"}})],1),a("el-form-item",{attrs:{label:"路由",prop:"make_path.route"}},[a("el-input",{model:{value:e.form.make_path.route,callback:function(t){e.$set(e.form.make_path,"route",t)},expression:"form.make_path.route"}})],1),a("el-form-item",{attrs:{label:"前端路由",prop:"make_path.router"}},[a("el-input",{model:{value:e.form.make_path.router,callback:function(t){e.$set(e.form.make_path,"router",t)},expression:"form.make_path.router"}})],1),a("el-form-item",{attrs:{label:"前端api",prop:"make_path.api"}},[a("el-input",{model:{value:e.form.make_path.api,callback:function(t){e.$set(e.form.make_path,"api",t)},expression:"form.make_path.api"}})],1),a("el-form-item",{attrs:{label:"前端页面",prop:"make_path.view"}},[a("el-input",{model:{value:e.form.make_path.view,callback:function(t){e.$set(e.form.make_path,"view",t)},expression:"form.make_path.view"}})],1)],1),a("code-generation-table",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],ref:"codeTable",attrs:{"crud-form-rule":e.crudFormRule,"table-list":e.tableList}}),a("div",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active === 2"}]},[a("div",{staticClass:"i-success"},[a("i",{staticClass:"el-icon-check primary-color d-border-radius-circle d-p-20"}),a("div",{staticClass:"d-mt-20"},[e._v("数据填写完成，点击完成生成crud")])])]),a("div",{staticClass:"d-text-center d-mt-30"},[a("el-button",{attrs:{disabled:0===e.active,size:"mini"},on:{click:e.up}},[e._v("上一步")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2!==e.active,expression:"active !== 2"}],attrs:{type:"primary",size:"mini"},on:{click:e.next}},[e._v("下一步")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active === 2"}],attrs:{type:"primary",size:"mini"},on:{click:e.finish}},[e._v("完成")])],1)],1)],1)},f=[],_=a("5530"),b=a("ed08"),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[a("el-table-column",{attrs:{label:"表单字段名","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{attrs:{disabled:r.is_primary_key,size:"mini",placeholder:"输入表单字段名称"},on:{blur:function(t){return e.table_column_name_blur(r)}},model:{value:r.table_column_name,callback:function(t){e.$set(r,"table_column_name",t)},expression:"row.table_column_name"}})]}}])}),a("el-table-column",{attrs:{label:"表单类型","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-select",{attrs:{disabled:r.is_primary_key,clearable:"",size:"mini",placeholder:"请选择表单类型"},model:{value:r.table_form_type,callback:function(t){e.$set(r,"table_form_type",t)},expression:"row.table_form_type"}},e._l(e.formType,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)]}}])}),a("el-table-column",{attrs:{label:"必填",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-switch",{attrs:{disabled:r.is_primary_key,size:"mini"},model:{value:r.is_required,callback:function(t){e.$set(r,"is_required",t)},expression:"row.is_required"}})]}}])}),a("el-table-column",{attrs:{label:"查询方式","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-select",{attrs:{disabled:r.is_primary_key,clearable:"",size:"mini",placeholder:"请选择查询方式"},model:{value:r.query_type,callback:function(t){e.$set(r,"query_type",t)},expression:"row.query_type"}},e._l(e.searchType,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)]}}])}),a("el-table-column",{attrs:{label:"显示",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-switch",{attrs:{disabled:r.is_primary_key,size:"mini"},model:{value:r.is_show,callback:function(t){e.$set(r,"is_show",t)},expression:"row.is_show"}})]}}])}),a("el-table-column",{attrs:{label:"字段名","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{attrs:{disabled:r.is_primary_key,size:"mini",placeholder:"输入表单字段名称"},model:{value:r.field,callback:function(t){e.$set(r,"field",t)},expression:"row.field"}})]}}])}),a("el-table-column",{attrs:{label:"字段类型","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-select",{attrs:{disabled:r.is_primary_key,size:"mini",placeholder:"请选择字段类型"},model:{value:r.field_type,callback:function(t){e.$set(r,"field_type",t)},expression:"row.field_type"}},e._l(e.fieldType,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)]}}])}),a("el-table-column",{attrs:{label:"长度","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{attrs:{disabled:r.is_primary_key,size:"mini",placeholder:"输入长度"},model:{value:r.length,callback:function(t){e.$set(r,"length",t)},expression:"row.length"}})]}}])}),a("el-table-column",{attrs:{label:"默认值","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{attrs:{disabled:r.is_primary_key,size:"mini",placeholder:"输入默认值"},model:{value:r.default_value,callback:function(t){e.$set(r,"default_value",t)},expression:"row.default_value"}})]}}])}),a("el-table-column",{attrs:{label:"描述","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{attrs:{disabled:r.is_primary_key,size:"mini",placeholder:"输入描述"},model:{value:r.comment,callback:function(t){e.$set(r,"comment",t)},expression:"row.comment"}})]}}])}),a("el-table-column",{attrs:{label:"关联表","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-cascader",{attrs:{disabled:r.is_primary_key,options:e.tableList,props:e.codeProps,size:"mini",placeholder:"请选择关联表",clearable:""},model:{value:r.hasOne,callback:function(t){e.$set(r,"hasOne",t)},expression:"row.hasOne"}})]}}])}),a("el-table-column",{attrs:{label:"索引",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-switch",{attrs:{disabled:r.is_primary_key,size:"mini"},model:{value:r.is_index,callback:function(t){e.$set(r,"is_index",t)},expression:"row.is_index"}})]}}])}),a("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,l=t.$index;return[r.is_primary_key?a("div",[e._v("----")]):a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.del(r,l)}}},[e._v("删除")])]}}])})],1),a("el-button",{staticClass:"d-mt-20",attrs:{type:"primary",size:"mini"},on:{click:e.addRow}},[e._v("添加一行")])],1)},v=[],k=(a("a434"),a("d3b7"),{props:{crudFormRule:{type:Object,default:null},tableList:{type:Array,default:null}},data:function(){return{tableData:[{id:1,table_column_name:"ID",table_form_type:"",is_required:!0,query_type:"=",is_show:!0,field:"id",field_type:"int",length:11,default_value:"",comment:"自增长ID",hasOne:"",is_index:!0,is_primary_key:!0,primary_key:1}],codeProps:{checkStrictly:!0,label:"value",lazy:!0,lazyLoad:function(e,t){var a=e.label;a&&c(a).then((function(e){var a=e.data;t(a)})).catch((function(){}))}}}},computed:{formType:function(){var e;return null===(e=this.crudFormRule)||void 0===e?void 0:e.form},searchType:function(){var e;return null===(e=this.crudFormRule)||void 0===e?void 0:e.search_type},fieldType:function(){var e;return null===(e=this.crudFormRule)||void 0===e?void 0:e.types}},methods:{table_column_name_blur:function(e){e.comment||(e.comment=e.table_column_name)},addRow:function(){if(!this.validateCodeForm())return!1;var e={table_column_name:"",table_form_type:"",is_required:!1,query_type:"",is_show:!0,field:"",field_type:"",length:"",default_value:"",comment:"",hasOne:"",is_index:!1,is_primary_key:!1};this.tableData.push(e)},del:function(e,t){var a=this;this.$confirm("确定删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.tableData.splice(t,1)})).catch((function(){}))},validateCodeForm:function(){var e=this.tableData[this.tableData.length-1];if(!e.table_column_name)return this.$message.error("请填写表单字段"),!1;if(!e.field)return this.$message.error("请填写字段名"),!1;if(!e.field_type)return this.$message.error("请填写字段类型"),!1;if(!e.length)return this.$message.error("请填写字段长度"),!1;var t=this.tableData.some((function(t){return t===e.field}));return!t||(this.$message.error("字段名重复"),!1)}}}),y=k,w=a("2877"),g=Object(w["a"])(y,h,v,!1,null,"1e709f8e",null),x=g.exports,$={components:{codeGenerationTable:x},data:function(){return{menuList:[],crudFormRule:{},tableList:[],form:{menu_path:[],table_name:"",menu_name:"",model_name:"",make_path:{controller:"app\\adminapi\\controller\\crud\\",model:"app\\model\\crud\\",dao:"app\\dao\\crud\\",route:"app\\adminapi\\route\\crud\\",service:"app\\services\\crud\\",router:"router\\modules\\crud\\",api:"api\\crud\\",view:"pages\\crud\\test\\"}},rules:{table_name:[{required:!0,message:"请填写表名",trigger:"blur"}],menu_name:[{required:!0,message:"请填写菜单名",trigger:"blur"}],model_name:[{required:!0,message:"请填写模块名",trigger:"blur"}],"make_path.controller":[{required:!0,message:"请填写控制器",trigger:"blur"}],"make_path.model":[{required:!0,message:"请填写模型",trigger:"blur"}],"make_path.dao":[{required:!0,message:"请填写dao层",trigger:"blur"}],"make_path.service":[{required:!0,message:"请填写service层",trigger:"blur"}],"make_path.route":[{required:!0,message:"请填写路由",trigger:"blur"}],"make_path.router":[{required:!0,message:"请填写前端路由",trigger:"blur"}],"make_path.api":[{required:!0,message:"请填写前端api",trigger:"blur"}],"make_path.view":[{required:!0,message:"请填写前端页面",trigger:"blur"}]},active:0}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;s().then((function(t){var a=t.data,r=a.menuList,l=a.formRule,i=a.tableList;e.menuList=r,e.crudFormRule=l,e.tableList=i})).catch((function(){}))},table_name_blur:function(){var e=this.form.table_name;if(!e)return!1;this.form.menu_name=this.form.model_name=e,this.form.make_path={controller:"app\\adminapi\\controller\\crud\\".concat(Object(b["c"])(e),".php"),model:"app\\model\\crud\\".concat(Object(b["c"])(e),".php"),dao:"app\\dao\\crud\\".concat(Object(b["c"])(e),"Dao.php"),route:"app\\adminapi\\route\\crud\\".concat(e,".php"),service:"app\\services\\crud\\".concat(Object(b["c"])(e),"Services.php"),router:"router\\modules\\crud\\".concat(e,".js"),api:"api\\crud\\".concat(e,".js"),view:"pages\\crud\\".concat(e,"\\index.vue")}},up:function(){this.active--<=0&&(this.active=0)},next:function(){var e=this;this.$refs.form.validate((function(t){if(t){if(1===e.active&&!e.$refs.codeTable.validateCodeForm())return!1;e.active<=1&&e.active++}}))},finish:function(){var e=this,t=0;this.form.menu_path.length>0&&(t=this.form.menu_path[-1]);var a=Object(_["a"])(Object(_["a"])({},this.form),{},{pid:t,tableData:this.$refs.codeTable.tableData});console.log(a),u(a).then((function(t){e.$message.success(t.msg)})).catch((function(){}))},back:function(){this.$emit("back")}}},z=$,S=(a("0aa4"),Object(w["a"])(z,p,f,!1,null,"708bc368",null)),q=S.exports,O={components:{codeGenerationForm:q},mixins:[d["a"]],data:function(){return{tableData:[],isShowForm:!1}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;this.loading__=!0;var t={page:this.currentPage__,limit:this.limit__};o(t).then((function(t){var a=t.data;e.tableData=a.list,e.total__=a.count,e.loading__=!1})).catch((function(){}))},add:function(){this.isShowForm=!0},edit:function(e){},del:function(e){var t=this;this.$confirm("此操作将永久删除该功能生成记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){m(e).then((function(e){t.$message.success(e.msg),t.initData()})).catch((function(){}))})).catch((function(){}))},back:function(){var e=this;this.$confirm("是否放弃编辑?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.isShowForm=!1})).catch((function(){}))}}},D=O,T=Object(w["a"])(D,r,l,!1,null,"59e2ea86",null);t["default"]=T.exports},6453:function(e,t,a){},a434:function(e,t,a){"use strict";var r=a("23e7"),l=a("23cb"),i=a("a691"),n=a("50c4"),o=a("7b0b"),s=a("65f0"),c=a("8418"),u=a("1dde"),m=a("ae40"),d=u("splice"),p=m("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,_=Math.min,b=9007199254740991,h="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!d||!p},{splice:function(e,t){var a,r,u,m,d,p,v=o(this),k=n(v.length),y=l(e,k),w=arguments.length;if(0===w?a=r=0:1===w?(a=0,r=k-y):(a=w-2,r=_(f(i(t),0),k-y)),k+a-r>b)throw TypeError(h);for(u=s(v,r),m=0;m<r;m++)d=y+m,d in v&&c(u,m,v[d]);if(u.length=r,a<r){for(m=y;m<k-r;m++)d=m+r,p=m+a,d in v?v[p]=v[d]:delete v[p];for(m=k;m>k-r+a;m--)delete v[m-1]}else if(a>r)for(m=k-r;m>y;m--)d=m+r-1,p=m+a-1,d in v?v[p]=v[d]:delete v[p];for(m=0;m<a;m++)v[m+y]=arguments[m+2];return v.length=k-r+a,u}})},a682:function(e,t,a){"use strict";t["a"]={data:function(){return{loading__:!0,currentPage__:1,limit__:20,total__:0}}}}}]);